GROUP ATOMS-1-1000:1 LABEL=na GROUP ATOMS=1001-2000:1 LABEL=cl GROUP ATOMS 2001-20000:3 LABEL=solv
a: FIXEDATOM AT=3.03831,3.03831,3.03831
# CuMD simulation ###
NSHELLSP...
    LABEL=n_na GROUP=na
    NASV=1
    NST=1000
    NAST=1
    DIN=1.7
    DOUT=2.5
    DF=2.6
    COIN=1.7 COOUT=2.5
    WF=0.2 WOUT=0.05 WIN=0.05 NOSCALE ... NSHELLSP
    NSHELLSP ... LABEL=n_cl
    GROUP CL
    NASV=1
    NST=1000
    NAST-1
    DIN=1.7
    DOUT-2.5
    DF=2.6
    COIN=1.7 COOUT=2.5
    WF 0.2 WOUT 0.05 WIN=0.05 NOSCALE
... NSHELLSP
RESTRAINT ARG=n_na AT=5.0 KAPPA=10000.0 LABEL=nares RESTRAINT ARG=n_cl AT=5.0 KAPPA-10000.0 LABEL=clres

REFCV...
    SPECIESA=na
    SPECIESB=cl
    SIGMA=0.08
    LATTICE
    CONSTANTS=0.282
    CRYSTAL STRUCTURE=SC
    LABEL=refcvna
    MORE THAN={RATIONAL R_0=0.5 NN=12 MM=24}
... REFCV
INSPHERE... LABEL=spherena ATOM=a
DATA=refcvna
RADIUS={CUBIC D_0=1. D_MAX=1.5}
MORE THAN={RATIONAL R_0=0.5 NN=12 MM=24} ... INSPHERE

COORDINATIONNUMBER ...
    LABEL=cn
    SPECIESA=na SPECIESB=solv
    SWITCH={RATIONAL R_0=0.4 D_MAX=0.6 NN-12 MM=24)
    MEAN
... COORDINATIONNUMBER
INSPHERE ...
    LABEL spherecn ATOM=a
    DATA=cn
    RADIUS={CUBIC D_0=1. D_MAX=1.5}
    MEAN
... INSPHERE

METAD...
    ARG-spherena.morethan,spherecn.mean
    BIASFACTOR=100
    GRID_MIN=0.0,0.0 GRID_MAX=70.0,15.0 GRID BIN-500,500 SIGMA=0.5,0.1
    TEMP=350.
    PACE=500
    LABEL=metad
    HEIGHT=30.
    REWEIGHTING_NGRID-500,500
... METAD

UPPER WALLS ARG-spherena.morethan AT-50. KAPPA 200 EXP=2 LABEL=uwall LOWER WALLS ARG-spherena.morethan AT-1.0 KAPPA=200 EXP=2 LABEL=lwall
UPPER WALLS ARG-spherecn.mean AT-12. KAPPA 200 EXP=2 LABEL=uwallcn LOWER WALLS ARG-spherecn.mean AT=2. KAPPA=200 EXP=2 LABEL=lwallcn

COORDINATIONNUMBER SPECIESA=na
SPECIESB=cl
LABEL=coord
SWITCH={CUBIC D_0=0.3 D_MAX=0.35}
MORE THAN={RATIONAL R_0=3. NN-12 MM=24} ... COORDINATIONNUMBER
INSPHERE ...
    LABEL=spherecoord
    ATOM=a
    DATA=coord
    RADIUS={CUBIC D_0=1. D_MAX=1.5}
    MORE THAN={RATIONAL R_0=3. NN-12 MM=24}
... INSPHERE
diffl: MATHEVAL ARG-sphere coord.morethan, spherena. more than FUNC=x-y PERIODIC=NO UPPER WALLS ARG=diff1 AT=2.0 KAPPA-100 EXP-2 LABEL=uwall2
diff2: MATHEVAL ARG=coord.morethan, sphere coord.morethan FUNC=x-y PERIODIC=NO UPPER WALLS ARG=diff2 AT=10.0 KAPPA-100 EXP=2 LABEL=uwal13

s0:
SH':
metad:
READ FILE=./COLVAR-4.2-III IGNORE_TIME VALUES=spherena.morethan READ FILE=./COLVAR-4.2-III IGNORE_TIME VALUES-spherecn. lessthan
lwall:
uwall:
uwall2:
uwal13: lwallcn:
uwallcn:
READ FILE=./COLVAR-4.2-III READ FILE=./COLVAR-4.2-III READ FILE=./COLVAR-4.2-III READ FILE=./COLVAR-4.2-III READ FILE=./COLVAR-4.2-III READ FILE=./COLVAR-4.2-III READ FILE=./COLVAR-4.2-III
IGNORE TIME VALUES-metad.rbias IGNORE TIME VALUES=lwall.bias IGNORE TIME VALUES=uwall.bias IGNORE TIME VALUES=uwall2.bias IGNORE TIME VALUES=uwall3. bias IGNORE TIME VALUES=lwallcn.bias
IGNORE TIME VALUES=uwallcn.bias
weights: REWEIGHT_METAD TEMP=350
ARG=metad.rbias, lwall. bias, uwall. bias, uwall2. bias, uwall3.bias, lwallcn.bias, uwallcn.bias
# Calculate histograms
HISTOGRAM ...
    ARG-50.morethan, SH'.lessthan
    GRID_MIN=0.0,0.0
    GRID_MAX=70.0,70.0
    GRID_BIN=100, 100
    BANDWIDTH=1,1
    LOGWEIGHTS=weights
    LABEL=hh1
    UPDATE_FROM=50000
... HISTOGRAM
# Print histograms to file
DUMPGRID GRID=hh1 FILE=histo_walll FMT=24.16e STRIDE=50000 # Read COLVAR-n5- forRwght file
ff1: CONVERT_TO_FES GRID=hh1 TEMP=350
DUMPGRID GRID=ff1 FILE=fes1.dat STRIDE=50000

GROUP ATOMS=1-1000:1 LABEL=na
GROUP ATOMS=1001-2000:1 LABEL=cl
bcom: FIXEDATOM AT=3.03831,3.03831,3.03831
REFCV ... SPECIESA=na SPECIESB-Cl
    SIGMA=0.08
    LATTICE CONSTANTS=0.282
    CRYSTAL STRUCTURE-SC
    LABEL=refcvna
    MORE THAN={RATIONAL R_0=0.5 NN=12 MM=24}
... REFCV
INSPHERE ...
    LABEL spherena
    ATOM=bcom
    DATA=refcvna
    RADIUS={CUBIC D_0=1. D_MAX=1.5}
    MORE THAN={RATIONAL R_0=0.5 NN-12 MM=24}
... INSPHERE
ff: MFILTER_MORE DATA=spherena SWITCH={RATIONAL R_0=0.5 NN-12}
cm: CONTACT MATRIX ATOMS-spherena SWITCH={CUBIC D_0=0.49 D_MAX=0.50)
dfs: DFSCLUSTERING MATRIX=cm
clust1: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER=1 MORE THAN={RATIONAL R_0=0.5 NN=12) SUM
clust2: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER-2 MORE THAN={RATIONAL R_0=0.5 NN=12) SUM
clust3: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER=3 MORE THAN={RATIONAL R_0=0.5 NN=12} SUM
clust4: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER=4 MORE THAN={RATIONAL R_0=0.5 NN=12) SUM
clust5: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER 5 MORE THAN={RATIONAL R_0=0.5 NN=12) SUM
clust6: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER 6 MORE THAN={RATIONAL R_0=0.5 NN=12) SUM
clust7: CLUSTER_PROPERTIES CLUSTERS=dfs CLUSTER 7 MORE THAN={RATIONAL R_0=0.5 NN=12} SUM
clust8: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER=8 MORE THAN={RATIONAL R_0=0.5 NN=12} SUM
clust9: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER 9 MORE THAN={RATIONAL R_0=0.5 NN=12) SUM
clust10: CLUSTER PROPERTIES CLUSTERS=dfs CLUSTER=10 MORE THAN={RATIONAL R_0=0.5 NN=12} SUM
metad:
lwall:
uwall:
uwal12:
uwal13:
lwallcn:
uwallcn:
READ FILE=../COLVAR IGNORE_TIME VALUES=metad.rbias READ FILE=../COLVAR IGNORE TIME VALUES=lwall. bias READ FILE=../COLVAR IGNORE TIME VALUES=uwall. bias READ FILE=../COLVAR IGNORE_TIME VALUES=uwal12.bias READ FILE=../COLVAR IGNORE TIME VALUES=uwal13.bias READ FILE=../COLVAR IGNORE TIME VALUES=lwallcn.bias READ FILE=../COLVAR IGNORE_TIME VALUES=uwallcn.bias
weights: REWEIGHT_METAD TEMP=350
ARG=metad.rbias, lwall. bias, uwall. bias, uwall2. bias, uwall3.bias, lwallcn.bias, uwallcn.bias
FLUSH STRIDE=1
PRINT ARG=* FILE=COLVAR-n5-I STRIDE=1

s1:
READ FILE=colvar2 IGNORE TIME VALUES=clust
metad:
READ FILE=colvar2
lwall:
READ FILE=colvar2
uwall:
uwall2:
uwal13:
READ FILE=colvar2 READ FILE=colvar2 READ FILE=colvar2
lwallcn:
READ FILE=colvar2
uwallcn:
READ FILE=colvar2
weights: REWEIGHT METAD TEMP=350
IGNORE TIME VALUES-metad.rbias IGNORE TIME VALUES-lwall.bias IGNORE TIME VALUES=uwall.bias IGNORE TIME VALUES=uwall2. bias IGNORE TIME VALUES=uwal13. bias IGNORE TIME VALUES=lwallcn.bias IGNORE TIME VALUES=uwallcn.bias
ARG=metad.rbias, lwall. bias, uwall. bias, uwall2. bias, uwall3.bias, lwallcn.bias, uwallcn.bias
#Calculate histograms
HISTOGRAM ...
    ARG=s1
    GRID_MIN=0.0
    GRID_MAX=60.0
    GRID BIN=200
    BANDWIDTH=0.1 LOGWEIGHTS=weights
    LABEL=hh1 
... HISTOGRAM
# Print histograms to file
DUMPGRID GRID=hh1 FILE=histo_walll FMT=24.16e
ff1: CONVERT TO FES GRID=hh1 TEMP=350
DUMPGRID GRID=ff1 FILE=fes1.dat